% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MZAnnotation.R
\name{AnnotateSM}
\alias{AnnotateSM}
\title{Annotates m/z values based on reference metabolite dataset}
\usage{
AnnotateSM(
  data,
  db,
  feature.metadata.assay = "Spatial",
  feature.metadata.slot = "raw_mz",
  ppm_error = 5,
  test_add_pos = c("M+H"),
  polarity = "pos",
  filepath = NULL,
  return.only.annotated = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{data}{Seurat Spatial Metabolomic Object containing m/z values for annotation.}

\item{db}{Reference metabolite dataset in the form of a Data.Frame.}

\item{feature.metadata.assay}{Character string defining the Seurat assay which contains the mz counts being annotated (default = "Spatial").}

\item{feature.metadata.slot}{Character string defining the Seurat assay slot which contains the raw mz values, this is without the 'mz-' and are a vector of integers. This is setup by default when running the cardinal_to_seurat() function (default = "raw_mz").}

\item{ppm_error}{Numeric value indicating the size of the ppm error allowed when matching molecular weights between Seurat object and reference dataset. If only want exact matches set ppm = 0 (default = 5).}

\item{test_add_pos}{List of adducts to use for searching the database (e.g. "M+NH4","M+Na","M+CH3OH+H","M+K" etc.) Look at db_adduct_filter() documentation for list of the possible adducts (default = "M+H").}

\item{polarity}{Character string defining the polarity of adducts to use, either "pos" or "neg" (default = "pos").}

\item{filepath}{Character string of the directory to store the _annotated_mz_peaks.csv. Else, set to NULL as default.}

\item{return.only.annotated}{Boolean value indicating if the annotated Seurat Object should only include m/z values that were successfully annotated (default = TRUE).}

\item{verbose}{Boolean indicating whether to show the message. If TRUE the message will be show, else the message will be suppressed (default = TRUE).}
}
\value{
A Seurat Object with m/z values annotated. These annotations are stored in the relative assay's meta.data (e.g. SeuratObj\verb{[["Spatial"]][[]]})
}
\description{
Annotates m/z values based on reference metabolite dataset
}
\examples{
# HMDB_db <- load("data/HMDB_1_names.rds")
# Annotated_SeuratObj <- AnnotateSM(SeuratObj, HMDB_db)
}
